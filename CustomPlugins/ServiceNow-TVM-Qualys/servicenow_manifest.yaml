Descriptor:  
  Name: ServiceNOW CVE & Software Inventory Search
  DisplayName: ServiceNOW CVE & Software Inventory Search
  Description: |
    Azure Functions API for analyzing vulnerabilities and software inventory in ServiceNow.
    
    This API provides endpoints to:
    - Analyze individual CVEs and QIDs for vulnerable systems
    - Batch analyze multiple vulnerabilities
    - Search vulnerabilities by confirmation status
    - Query software inventory by manufacturer or product name
    
    API endpoint descriptions & usage guidelines:
    /analyze-vulnerability
     - Use when the user asks about a single CVE or Qualys QID.
     - Returns the total number of vulnerable systems, sample affected systems, and ServiceNOW deep links.
     - Best for: "Is my environment vulnerable to CVE-2025-55225?"

    /batch-analyze
     - Use when the user provides multiple CVEs or QIDs in a single query.
     - Returns results for each identifier with counts and ServiceNOW deep links.
     - Best for "Check both CVE-2023-44487 and CVE-2025-55225."

    /software-inventory
     - Use when the user asks about installed software by product name or manufacturer.
     - Supports wildcards (`*`) for broader searches.
     - Returns total installations, version distribution, sample systems, and ServiceNOW links.
     - Best for "How many hosts have Microsoft Office installed?"

    /status-search
     - Use when the user wants vulnerabilities filtered by confirmation state.
     - Returns vulnerabilities grouped by status ("confirmed", "unconfirmed", or "all").
     - Best for "Show me all confirmed vulnerabilities in ServiceNOW."
    
  
    Focus on these primary metrics:
    
    **For Vulnerability Analysis:**
    - `statistics.total_vulnerable_systems` - The count of affected systems (primary impact metric)
    - `cvss_score` - Severity rating (9.0+ critical, 7.0+ high priority)
    - `systems[].assignment_group` - Teams responsible for remediation
    
    **For Software Inventory:**
    - `total_installations` - Deployment scale across environment
    - Version distribution - Identify outdated software requiring updates
    - `manufacturer` verification - Ensure correct vendor association
    
    **Best Practices:**
    - Use `confirmation_state: "confirmed"` for actionable vulnerabilities
    - Always return servicenow_urls when present in the API response
    - Set `fetch_all_details: false` for faster initial assessments
    - Leverage wildcards (*) in software searches for broader discovery
    - Focus on high CVSS scores AND high system counts for prioritization


  SupportedAuthTypes:
    - ApiKey
  Authorization:  
    Type: APIKey  
    Location: Header  
    Key: X-API-Key
    AuthScheme: ''

SkillGroups:  
  - Format: API  
    Settings:  
      OpenApiSpecUrl: https://raw.githubusercontent.com/cd1zz/securitycopilot/refs/heads/main/CustomPlugins/ServiceNow-TVM-Qualys/service_now_openapi.yaml
